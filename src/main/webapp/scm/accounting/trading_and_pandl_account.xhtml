<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns:f="http://xmlns.jcp.org/jsf/core"  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" xmlns:p="http://primefaces.org/ui" xmlns:c="http://xmlns.jcp.org/jsp/jstl/core" xmlns:o="http://omnifaces.org/ui"  >
  <!--#{accountingMainView.init(main)}--> 
 #{tradingaccountView.switchTrading(main, viewType)}
   <p:importConstants type="spica.constant.AccountingConstant" var="AccountingConstant" />
  <ui:decorate template="/WEB-INF/resources/theme1/pageBasic.xhtml">
    <ui:param name="label" value="#{lang.tradingaccount} #{lang.andSymbol} #{lang.profitandloss}"/>
    <ui:param name="navLabel" value=""/>
    <ui:param name="ids" value="tradingaccount"/>
    <ui:param name="deleteListMenu" value="false"/>
    <ui:param name="search" value="false"/>

    <ui:define name="deleteList"/>    
    <ui:define name="menu1"/>
    <ui:define name="deleteForm"/>
    <ui:define name="save"/>

    <ui:define name="more" ></ui:define>
    <ui:define name="newList" ></ui:define>

    <ui:define name="form">
    </ui:define>
    <ui:define name="leftRightList">
      <p:commandButton value="#{lang.export}" styleClass="btn btn-primary" action="#{tradingaccountView.export(main)}" ajax="false" immediate="true"  />
    </ui:define>
    <ui:define name="rightList" >
      
       <h:panelGroup styleClass="L" >
          <p:selectOneMenu value="#{tradingaccountView.accountingMainView.selectedAccount}" var="a" filter="true" filterMatchMode="contains" 
                               converter="omnifaces.SelectItemsConverter" height="450">
                <f:selectItems  var="acc" value="#{tradingaccountView.accountList}" itemLabel="#{acc.vendorId.vendorName}" itemValue="#{acc}" />                
                <p:column style="width:350px;color:#{a.accountId ne null?'#555':'#000'} ">
                  <p:fragment rendered="#{a.accountId ne null}">
                    <h:outputText value="&#160;&#160;&#160;#{a.vendorId.vendorName}" styleClass="fa fa-angle-right" title="#{lang.secondary} #{lang.account}" />
                  </p:fragment>  
                  <p:fragment rendered="#{a.accountId eq null}">
                    <h:outputText value="#{a.vendorId.vendorName}"  />
                  </p:fragment>
                </p:column>
                <p:column style="width:100px;color:#{a.accountId ne null?'#555':'#000'}">
                  <p:fragment rendered="#{a.accountId ne null}">
                    <h:outputText value="&#160;&#160;&#160;#{a.accountCode}"  style="width:100px;color:#555;"  />                     
                  </p:fragment>
                  <p:fragment rendered="#{a.accountId eq null}">
                    <h:outputText value="&#160;&#160;&#160;#{a.accountCode}"  style="width:100px;color:#000;"  />                      
                  </p:fragment>
                </p:column>
                <p:ajax event="itemSelect" update="tradingGrid pandlGrid " listener="#{tradingaccountView.selectAccount(main)}"  onstart="block()" oncomplete="unblock()" />
              </p:selectOneMenu>
      </h:panelGroup> 
      
      <h:panelGroup styleClass="L" id="accountGroupId" rendered="false">
        <p:selectOneMenu var="e" value="#{tradingaccountView.accountingMainView.selectedAccountGroup}" filter="true" filterMatchMode="contains" 
                         converter="omnifaces.SelectItemsConverter" height="450">
          <f:selectItems  var="accGroup" value="#{tradingaccountView.accountGroupList}" itemLabel="#{accGroup.groupName}" itemValue="#{accGroup}" />          
          <p:column style="width: 350px;">
            <h:outputText value="#{e.groupName}"  />
          </p:column>
          <p:column style="width: 50px;">
            <h:outputText value="#{e.groupCode}"  />                          
          </p:column>
          <p:column style="width: 50px;">
            <p:fragment rendered="#{e.isDefault eq 0}">
              <i class="fa fa-th" title="#{lang.custom} #{lang.accountGroup}" ></i>
            </p:fragment>
            <p:fragment rendered="#{e.isDefault eq 1}">
              <!--<i class="fa fa-square-o" style="color:#CCC;" ></i>-->
            </p:fragment>
          </p:column>
          <p:ajax event="itemSelect" listener="#{tradingaccountView.selectAccountGroup(main)}" update="tradingGrid pandlGrid" onstart="block();" oncomplete="unblock();"  />
        </p:selectOneMenu>
      </h:panelGroup>  
      <h:inputText id="forFocus" styleClass="sr-only" />
      <h:panelGroup styleClass="L">
        <p:calendar id="fromDate" value="#{accountingMainView.fromDate}" pattern="#{lang.datePattern}"
                    required="true" requiredMessage="#{lang.fromDate} #{lang.isRequired}" styleClass="fw"
                    converterMessage="#{lang.fromDate} #{lang.invalidDate}" title="#{lang.fromDate}" pages="1" mindate="#{userRuntimeView.company.currentFinancialYear.startDate}"
                    maxlength="12" size="9"  showButtonPanel="true" navigator="true" mask="true" maxdate="#{accountingMainView.toDate}" >
          <p:ajax event="dateSelect" process="@this"  listener="#{tradingaccountView.onFromDateSelect}" update="tradingGrid pandlGrid fmess toDate" onstart="block();" oncomplete="unblock();"  />
        </p:calendar>
        <p:message for="fromDate" display="text" id="fmess" />
      </h:panelGroup>     
      <h:panelGroup styleClass="L">
        <p:calendar id="toDate" value="#{accountingMainView.toDate}" pattern="#{lang.datePattern}" validator="#{sysRuntimeView.dateLteToday}"
                    required="true" requiredMessage="#{lang.toDate} #{lang.isRequired}" styleClass="fw"
                    converterMessage="#{lang.toDate} #{lang.invalidDate}" title="#{lang.toDate}" pages="1" mindate="#{accountingMainView.fromDate}"
                    maxlength="12" size="9"  showButtonPanel="true" navigator="true" mask="true"  maxdate="#{userRuntimeView.company.currentFinancialYear.endDate}">
          <p:ajax event="dateSelect" process="@this"  listener="#{tradingaccountView.onToDateSelect}" update="tradingGrid pandlGrid tmess" onstart="block();" oncomplete="unblock();"  />
        </p:calendar>
        <p:message for="toDate" display="text" id="tmess"/>
      </h:panelGroup>
    </ui:define>
    <ui:define name="list">   
      <ui:include src="trading_account_view.xhtml" />
      <ui:include src="pandl_account_view.xhtml" />
    </ui:define>
  </ui:decorate>
</ui:composition>